"use strict";exports.id=649,exports.ids=[649],exports.modules={3649:(a,b,c)=>{c.d(b,{offchainLookup:()=>G,offchainLookupSignature:()=>E});var d=c(306),e=c(9390),f=c(7616),g=c(448);class h extends f.C{constructor({callbackSelector:a,cause:b,data:c,extraData:d,sender:e,urls:f}){super(b.shortMessage||"An error occurred while fetching for an offchain result.",{cause:b,metaMessages:[...b.metaMessages||[],b.metaMessages?.length?"":[],"Offchain Gateway Call:",f&&["  Gateway URL(s):",...f.map(a=>`    ${(0,g.I)(a)}`)],`  Sender: ${e}`,`  Data: ${c}`,`  Callback selector: ${a}`,`  Extra data: ${d}`].flat(),name:"OffchainLookupError"})}}class i extends f.C{constructor({result:a,url:b}){super("Offchain gateway response is malformed. Response data must be a hex value.",{metaMessages:[`Gateway URL: ${(0,g.I)(b)}`,`Response: ${(0,e.A)(a)}`],name:"OffchainLookupResponseMalformedError"})}}class j extends f.C{constructor({sender:a,to:b}){super("Reverted sender address does not match target contract address (`to`).",{metaMessages:[`Contract address: ${b}`,`OffchainLookup sender address: ${a}`],name:"OffchainLookupSenderMismatchError"})}}var k=c(8e3),l=c(3923),m=c(4884),n=c(7449),o=c(2672),p=c(5866),q=c(4573),r=c(144),s=c(7426),t=c(8917),u=c(3598),v=c(6494),w=c(9478),x=c(854),y=c(8230);let z="/docs/contract/encodeErrorResult";function A(a){let{abi:b,errorName:c,args:d}=a,e=b[0];if(c){let a=(0,y.iY)({abi:b,args:d,name:c});if(!a)throw new t.yy(c,{docsPath:z});e=a}if("error"!==e.type)throw new t.yy(void 0,{docsPath:z});let f=(0,x.B)(e),g=(0,v.V)(f),h="0x";if(d&&d.length>0){if(!e.inputs)throw new t.ZP(e.name,{docsPath:z});h=(0,m.h)(e.inputs,d)}return(0,p.aP)([g,h])}let B="/docs/contract/encodeFunctionResult",C="x-batch-gateway:true";async function D(a){let{data:b,ccipRequest:c}=a,{args:[d]}=function(a){let{abi:b,data:c}=a,d=(0,u.di)(c,0,4),e=b.find(a=>"function"===a.type&&d===(0,v.V)((0,x.B)(a)));if(!e)throw new t.EB(d,{docsPath:"/docs/contract/decodeFunctionData"});return{functionName:e.name,args:"inputs"in e&&e.inputs&&e.inputs.length>0?(0,w.n)(e.inputs,(0,u.di)(c,4)):void 0}}({abi:r.b2,data:b}),e=[],f=[];return await Promise.all(d.map(async(a,b)=>{try{f[b]=a.urls.includes(C)?await D({data:a.data,ccipRequest:c}):await c(a),e[b]=!1}catch(a){var d;e[b]=!0,f[b]="HttpRequestError"===(d=a).name&&d.status?A({abi:r.b2,errorName:"HttpError",args:[d.status,d.shortMessage]}):A({abi:[s.Mc],errorName:"Error",args:["shortMessage"in d?d.shortMessage:d.message]})}})),function(a){let{abi:b,functionName:c,result:d}=a,e=b[0];if(c){let a=(0,y.iY)({abi:b,name:c});if(!a)throw new t.Iz(c,{docsPath:B});e=a}if("function"!==e.type)throw new t.Iz(void 0,{docsPath:B});if(!e.outputs)throw new t.MR(e.name,{docsPath:B});let f=(()=>{if(0===e.outputs.length)return[];if(1===e.outputs.length)return[d];if(Array.isArray(d))return d;throw new t.dm(d)})();return(0,m.h)(e.outputs,f)}({abi:r.b2,functionName:"query",result:[e,f]})}let E="0x556f1830",F={name:"OffchainLookup",type:"error",inputs:[{name:"sender",type:"address"},{name:"urls",type:"string[]"},{name:"callData",type:"bytes"},{name:"callbackFunction",type:"bytes4"},{name:"extraData",type:"bytes"}]};async function G(a,{blockNumber:b,blockTag:c,data:e,to:f}){let{args:g}=(0,l.W)({data:e,abi:[F]}),[i,k,q,r,s]=g,{ccipRead:t}=a,u=t&&"function"==typeof t?.request?t.request:H;try{if(!function(a,b){if(!(0,o.P)(a,{strict:!1}))throw new n.M({address:a});if(!(0,o.P)(b,{strict:!1}))throw new n.M({address:b});return a.toLowerCase()===b.toLowerCase()}(f,i))throw new j({sender:i,to:f});let e=k.includes(C)?await D({data:q,ccipRequest:u}):await u({data:q,sender:i,urls:k}),{data:g}=await (0,d.T)(a,{blockNumber:b,blockTag:c,data:(0,p.xW)([r,(0,m.h)([{type:"bytes"},{type:"bytes"}],[e,s])]),to:f});return g}catch(a){throw new h({callbackSelector:r,cause:a,data:e,extraData:s,sender:i,urls:k})}}async function H({data:a,sender:b,urls:c}){let d=Error("An unknown error occurred.");for(let f=0;f<c.length;f++){let g=c[f],h=g.includes("{data}")?"GET":"POST",j="POST"===h?{data:a,sender:b}:void 0,l="POST"===h?{"Content-Type":"application/json"}:{};try{let c,f=await fetch(g.replace("{sender}",b.toLowerCase()).replace("{data}",a),{body:JSON.stringify(j),headers:l,method:h});if(c=f.headers.get("Content-Type")?.startsWith("application/json")?(await f.json()).data:await f.text(),!f.ok){d=new k.Ci({body:j,details:c?.error?(0,e.A)(c.error):f.statusText,headers:f.headers,status:f.status,url:g});continue}if(!(0,q.q)(c)){d=new i({result:c,url:g});continue}return c}catch(a){d=new k.Ci({body:j,details:a.message,url:g})}}throw d}}};